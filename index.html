<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planning Applications Dashboard - Department of Planning</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #0056b3;
            --secondary-color: #003d82;
            --accent-color: #28a745;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --text-color: #333;
            --border-radius: 4px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            color: var(--text-color);
            line-height: 1.6;
            background-color: #f5f5f5;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Header Styles */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo img {
            height: 60px;
            margin-right: 15px;
        }
        
        .logo-text h1 {
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .logo-text p {
            font-size: 0.9rem;
            color: var(--dark-color);
        }
        
        .social-links {
            display: flex;
            gap: 15px;
        }
        
        .social-links a {
            color: var(--primary-color);
            font-size: 1.2rem;
            transition: color 0.3s;
        }
        
        .social-links a:hover {
            color: var(--secondary-color);
        }
        
        /* Navigation */
        nav {
            background-color: var(--primary-color);
        }
        
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
        }
        
        .nav-links li {
            position: relative;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            display: block;
            transition: background-color 0.3s;
        }
        
        .nav-links a:hover {
            background-color: var(--secondary-color);
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0, 86, 179, 0.8), rgba(0, 61, 130, 0.9));
            color: white;
            padding: 40px 0;
            text-align: center;
        }
        
        .hero h2 {
            font-size: 2.2rem;
            margin-bottom: 15px;
        }
        
        .hero p {
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* Dashboard Container */
        .dashboard-container {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin: 30px auto;
            padding: 30px;
        }
        
        .nav-tabs {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 20px;
        }
        
        .nav-tab {
            cursor: pointer;
            margin-right: 10px;
            padding: 12px 24px;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            background: #e5e7eb;
            display: inline-block;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .nav-tab.active {
            background: var(--primary-color);
            color: white;
        }
        
        .btn {
            cursor: pointer;
            border: none;
            border-radius: var(--border-radius);
            padding: 10px 16px;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--secondary-color);
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: var(--border-radius);
            color: white;
            font-weight: bold;
            font-size: 0.85rem;
        }
        
        .status-approved { background: #16a34a; }
        .status-rejected { background: #b91c1c; }
        .status-review { background: #f59e0b; }
        .status-submitted { background: var(--primary-color); }
        
        .workflow-stage {
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .hidden { display: none; }
        
        /* Stats Section */
        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-box {
            background: var(--light-color);
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            flex: 1;
            border-left: 4px solid var(--primary-color);
        }
        
        .stat-box h3 {
            margin: 0 0 10px 0;
            font-size: 2rem;
            color: var(--primary-color);
        }
        
        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
            text-align: left;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        /* Search and Filter */
        .search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .search-filter input, .search-filter select {
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: var(--border-radius);
            flex: 1;
        }
        
        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal.active { display: flex; }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-content h2 {
            margin-bottom: 20px;
            color: var(--primary-color);
            border-bottom: 2px solid var(--light-color);
            padding-bottom: 10px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            margin: 6px 0 15px 0;
            border-radius: var(--border-radius);
            border: 1px solid #ced4da;
            box-sizing: border-box;
            font-size: 1rem;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* Tracking Result */
        #tracking-result {
            margin-top: 20px;
        }
        
        .tracking-card {
            background: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary-color);
        }
        
        .tracking-card h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .tracking-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        /* Footer */
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 40px 0 20px;
            margin-top: 50px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .footer-section h3 {
            margin-bottom: 20px;
            color: var(--light-color);
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: #ccc;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-links a:hover {
            color: white;
        }
        
        .disclaimer {
            background-color: #1a1a1a;
            padding: 20px 0;
            margin-top: 30px;
        }
        
        .disclaimer p {
            font-size: 0.9rem;
            color: #999;
            margin-bottom: 10px;
        }
        
        /* Responsive Styles */
        @media (max-width: 992px) {
            .nav-links {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background-color: var(--primary-color);
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .stats {
                flex-direction: column;
            }
            
            .search-filter {
                flex-direction: column;
            }
        }
        
        @media (max-width: 768px) {
            .header-top {
                flex-direction: column;
                text-align: center;
            }
            
            .logo {
                margin-bottom: 15px;
            }
            
            .hero h2 {
                font-size: 1.8rem;
            }
            
            .hero p {
                font-size: 1rem;
            }
            
            table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-top">
                <div class="logo">
                    <img src="https://planning.gov.bm/wp-content/uploads/2018/11/logo.png" alt="Bermuda Department of Planning Logo">
                    <div class="logo-text">
                        <h1>Department of Planning</h1>
                        <p>Government of Bermuda</p>
                    </div>
                </div>
                <div class="social-links">
                    <a href="https://www.facebook.com/Department-of-Planning-Government-of-Bermuda-409153532514524/" target="_blank"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://www.youtube.com/@deptofplanningbermuda" target="_blank"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
        </div>
        
        <nav>
            <div class="container nav-container">
                <ul class="nav-links">
                    <li><a href="https://planning.gov.bm/">Home</a></li>
                    <li><a href="https://planning.gov.bm/index.php/customer-self-service/">Customer Self Service</a></li>
                    <li><a href="https://planning.gov.bm/index.php/development-plans/">Development Plans</a></li>
                    <li><a href="https://planning.gov.bm/index.php/building-codes/">Building Codes</a></li>
                    <li><a href="https://planning.gov.bm/index.php/procedures-and-guidance-notes/">Procedures & Guidance</a></li>
                    <li><a href="https://planning.gov.bm/index.php/contact/">Contact</a></li>
                </ul>
                <button class="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h2>Planning Applications Dashboard</h2>
            <p>Track and manage planning applications with the Department of Planning</p>
        </div>
    </section>

    <!-- Dashboard Container -->
    <div class="container">
        <div class="dashboard-container">
            <div class="nav-tabs">
                <span class="nav-tab active" onclick="showTab('dashboard', event)">Dashboard</span>
                <span class="nav-tab" onclick="showTab('applications', event)">All Applications</span>
                <span class="nav-tab" onclick="showTab('track', event)">Track Application</span>
            </div>

            <!-- Dashboard Tab -->
            <div id="dashboard-tab">
                <div class="stats">
                    <div class="stat-box">
                        <h3 id="total-applications">0</h3>
                        Total Applications
                    </div>
                    <div class="stat-box">
                        <h3 id="pending-review">0</h3>
                        Pending Review
                    </div>
                    <div class="stat-box">
                        <h3 id="approved-month">0</h3>
                        Approved
                    </div>
                </div>
                <button class="btn btn-primary" onclick="showNewApplicationModal()">Submit New Application</button>
            </div>

            <!-- Applications Tab -->
            <div id="applications-tab" class="hidden">
                <div class="search-filter">
                    <input type="text" id="search-input" placeholder="Search by Applicant, Property, or ID" onkeyup="filterApplications()">
                    <select id="filter-status" onchange="filterApplications()">
                        <option value="all">All Statuses</option>
                        <option value="submitted">Submitted</option>
                        <option value="review">Under Review</option>
                        <option value="approved">Approved</option>
                        <option value="rejected">Rejected</option>
                    </select>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Applicant</th>
                            <th>Property Address</th>
                            <th>Type</th>
                            <th>Submitted</th>
                            <th>Stage</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="applications-tbody"></tbody>
                </table>
            </div>

            <!-- Track Application Tab -->
            <div id="track-tab" class="hidden">
                <div class="search-filter">
                    <input type="text" id="tracking-id" placeholder="Enter Application ID (e.g., GN1037/2025)">
                    <button class="btn btn-primary" onclick="trackApplication()">Track Application</button>
                </div>
                <div id="tracking-result"></div>
            </div>
        </div>
    </div>

    <!-- New Application Modal -->
    <div id="new-application-modal" class="modal">
        <div class="modal-content">
            <h2>New Planning Application</h2>
            <form onsubmit="submitApplication(event)">
                <input type="text" id="app-id" placeholder="Application ID (e.g., GN1037/2025)" required>
                <input type="text" id="applicant-name" placeholder="Applicant Name" required>
                <input type="text" id="property-address" placeholder="Property Address" required>
                <select id="app-type" required>
                    <option value="">Select Application Type</option>
                    <option value="Renovation">Renovation</option>
                    <option value="New Construction">New Construction</option>
                    <option value="Change of Use">Change of Use</option>
                    <option value="Demolition">Demolition</option>
                    <option value="Subdivision">Subdivision</option>
                    <option value="Retaining Wall">Retaining Wall</option>
                    <option value="New Construction / Duplex">New Construction / Duplex</option>
                    <option value="Additions / Renovation">Additions / Renovation</option>
                    <option value="Retaining Wall / Sidewalk Modification">Retaining Wall / Sidewalk Modification</option>
                </select>
                <textarea id="description" placeholder="Brief Description" required></textarea>
                <input type="date" id="submit-date" required>
                <input type="email" id="contact-email" placeholder="Contact Email" required>
                <div class="form-buttons">
                    <button type="submit" class="btn btn-primary">Submit Application</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Department of Planning</h3>
                    <p>Government of Bermuda</p>
                    <p>Seven Arches Building, 3rd Floor</p>
                    <p>44 Church Street, City of Hamilton</p>
                    <p>HM12, Bermuda</p>
                </div>
                
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="https://planning.gov.bm/index.php/customer-self-service/">Customer Self Service</a></li>
                        <li><a href="https://planning.gov.bm/index.php/development-plans/">Development Plans</a></li>
                        <li><a href="https://planning.gov.bm/index.php/forms/">Forms</a></li>
                        <li><a href="https://planning.gov.bm/index.php/procedures-and-guidance-notes/">Procedures & Guidance</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Connect With Us</h3>
                    <div class="social-links">
                        <a href="https://www.facebook.com/Department-of-Planning-Government-of-Bermuda-409153532514524/" target="_blank"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.youtube.com/@deptofplanningbermuda" target="_blank"><i class="fab fa-youtube"></i></a>
                    </div>
                    <div style="margin-top: 20px;">
                        <a href="https://planning.gov.bm/index.php/privacy-notice/" style="color: #ccc; text-decoration: underline;">Privacy Notice</a>
                    </div>
                </div>
            </div>
            
            <div class="disclaimer">
                <p><strong>DISCLAIMER:</strong> Information provided on the Department of Planning website is intended to allow the public convenient access to Planning services and information. While all attempts are made to provide accurate, current and reliable information the Department of Planning and the Government of Bermuda do not guarantee that the information will be error free.</p>
                <p>Therefore, the Department of Planning and the Government of Bermuda and their respective employees, officers and agencies expressly make no warranty of the accuracy, reliability or timeliness of any information published through their websites and shall not be held liable for any losses caused by reliance upon the accuracy, completeness, reliability or timeliness of such information.</p>
            </div>
        </div>
    </footer>

    <script>
        let applications = JSON.parse(localStorage.getItem('planning_applications')) || [
            // Recent applications (last 4 weeks)
            { id: 11, appId: 'GN1037/2025', applicantName: 'Jerry Webb', propertyAddress: '7 Gatehouse Lane, Sandys', appType: 'New Construction / Duplex', description: 'Two‑storey detached house with 2 units, attached garage, driveway/parking and retaining walls', submitDate: '2025-11-17', status: 'submitted', currentStage: 'Initial Review', contactEmail: 'jerry.webb@email.bm'},
            { id: 12, appId: 'GN1022/2025', applicantName: 'Charles Butterfield', propertyAddress: '1 Between the Walls, Pembroke', appType: 'Retaining Wall / Sidewalk Modification', description: 'Retaining wall, roadside sidewalk and remove existing stairs', submitDate: '2025-11-10', status: 'submitted', currentStage: 'Initial Review', contactEmail: 'c.butterfield@email.bm'},
            { id: 13, appId: 'GN1015/2025', applicantName: 'Maria Rodriguez', propertyAddress: '23 Harbour Road, Paget', appType: 'Additions / Renovation', description: 'Single-storey extension to rear of property and interior renovation', submitDate: '2025-11-05', status: 'review', currentStage: 'Planning Review', contactEmail: 'm.rodriguez@email.bm'},
            { id: 14, appId: 'GN1008/2025', applicantName: 'Thomas Wilson', propertyAddress: '45 South Road, Warwick', appType: 'New Construction', description: 'Detached single-family residence with pool and landscaping', submitDate: '2025-10-29', status: 'review', currentStage: 'Environmental Assessment', contactEmail: 't.wilson@email.bm'},
            
            // Applications from 5-8 weeks ago
            { id: 15, appId: 'GN0992/2025', applicantName: 'Lisa Patterson', propertyAddress: '12 Middle Road, Southampton', appType: 'Change of Use', description: 'Convert ground floor from residential to professional office', submitDate: '2025-10-15', status: 'approved', currentStage: 'Completed', contactEmail: 'l.patterson@email.bm'},
            { id: 16, appId: 'GN0985/2025', applicantName: 'Robert Greene', propertyAddress: '8 Church Street, Hamilton', appType: 'Renovation', description: 'Facade restoration and interior refurbishment of historic building', submitDate: '2025-10-08', status: 'review', currentStage: 'Heritage Review', contactEmail: 'r.greene@email.bm'},
            { id: 17, appId: 'GN0978/2025', applicantName: 'Jennifer Taylor', propertyAddress: '34 North Shore Road, Hamilton Parish', appType: 'Demolition', description: 'Demolish existing structure and site clearance', submitDate: '2025-10-01', status: 'approved', currentStage: 'Completed', contactEmail: 'j.taylor@email.bm'},
            { id: 18, appId: 'GN0971/2025', applicantName: 'David Chen', propertyAddress: '56 Front Street, St. George', appType: 'Retaining Wall', description: 'Construction of 2.5m retaining wall along property boundary', submitDate: '2025-09-24', status: 'review', currentStage: 'Engineering Review', contactEmail: 'd.chen@email.bm'},
            
            // Applications from 9-12 weeks ago
            { id: 19, appId: 'GN0964/2025', applicantName: 'Sarah Johnson', propertyAddress: '78 Berry Hill Road, Paget', appType: 'Subdivision', description: 'Subdivide property into two residential lots', submitDate: '2025-09-17', status: 'approved', currentStage: 'Completed', contactEmail: 's.johnson@email.bm'},
            { id: 20, appId: 'GN0957/2025', applicantName: 'Michael Brown', propertyAddress: '90 South Road, Devonshire', appType: 'New Construction / Duplex', description: 'Two-unit residential building with shared driveway', submitDate: '2025-09-10', status: 'approved', currentStage: 'Completed', contactEmail: 'm.brown@email.bm'},
            { id: 21, appId: 'GN0950/2025', applicantName: 'Amanda White', propertyAddress: '15 Harbour Road, Paget', appType: 'Additions / Renovation', description: 'Second-storey addition and complete interior renovation', submitDate: '2025-09-03', status: 'approved', currentStage: 'Completed', contactEmail: 'a.white@email.bm'},
            { id: 22, appId: 'GN0943/2025', applicantName: 'Christopher Lee', propertyAddress: '27 Middle Road, Warwick', appType: 'Retaining Wall / Sidewalk Modification', description: 'Retaining wall reconstruction and sidewalk improvements', submitDate: '2025-08-27', status: 'approved', currentStage: 'Completed', contactEmail: 'c.lee@email.bm'},
            { id: 23, appId: 'GN0834/2025', applicantName: 'Charles Ndiaye', propertyAddress: '118 Middle Road, Southampton', appType: 'Additions / Renovation', description: 'Lower‑floor additions, new upper‑storey master suite, garden shed and landscape works', submitDate: '2025-08-29', status: 'approved', currentStage: 'Completed', contactEmail: 'c.ndiaye@email.bm'},
            
            // Older applications (kept for reference)
            { id:1, appId:'PA-2024-1001', applicantName:'Sarah Johnson', propertyAddress:'45 South Road, Paget', appType:'Renovation', description:'Two-story addition to existing residence', submitDate:'2024-11-01', status:'review', currentStage:'Conservation', contactEmail:'sjohnson@email.bm'},
            { id:2, appId:'PA-2024-1002', applicantName:'Michael Chen', propertyAddress:'12 Harbour Road, Hamilton', appType:'New Construction', description:'Commercial office building - 3 stories', submitDate:'2024-11-10', status:'submitted', currentStage:'Initial Review', contactEmail:'mchen@realty.bm'},
            { id:3, appId:'PA-2024-1003', applicantName:'Emily Thompson', propertyAddress:'78 Middle Road, Southampton', appType:'Change of Use', description:'Convert residential to commercial retail', submitDate:'2024-10-15', status:'approved', currentStage:'Completed', contactEmail:'ethompson@email.bm'},
            { id:4, appId:'PA-2024-1004', applicantName:'David Brown', propertyAddress:'22 Church Street, Hamilton', appType:'Demolition', description:'Demolish old warehouse for redevelopment', submitDate:'2024-11-05', status:'review', currentStage:'Planning Review', contactEmail:'dbrown@construction.bm'},
            { id:5, appId:'PA-2024-1005', applicantName:'Olivia Green', propertyAddress:'90 Front Street, St. George', appType:'Subdivision', description:'Divide land into 3 residential lots', submitDate:'2024-10-28', status:'approved', currentStage:'Completed', contactEmail:'ogreen@landdev.bm'},
            { id:6, appId:'PA-2024-1006', applicantName:'James Smith', propertyAddress:'15 King Street, Pembroke', appType:'Renovation', description:'Renovate historic townhouse', submitDate:'2024-11-12', status:'submitted', currentStage:'Initial Review', contactEmail:'jsmith@email.bm'},
            { id:7, appId:'PA-2024-1007', applicantName:'Sophia Lee', propertyAddress:'3 Queen Street, Hamilton', appType:'New Construction', description:'Construct new retail complex', submitDate:'2024-11-08', status:'review', currentStage:'Planning Review', contactEmail:'slee@retail.bm'},
            { id:8, appId:'PA-2024-1008', applicantName:'William Turner', propertyAddress:'57 Bay Road, Warwick', appType:'Change of Use', description:'Convert office to apartments', submitDate:'2024-11-02', status:'rejected', currentStage:'Rejected', contactEmail:'wturner@housing.bm'},
            { id:9, appId:'PA-2024-1009', applicantName:'Isabella Martinez', propertyAddress:'88 Middle Road, Southampton', appType:'Subdivision', description:'Split property into 2 commercial lots', submitDate:'2024-11-15', status:'submitted', currentStage:'Initial Review', contactEmail:'imartinez@email.bm'},
            { id:10, appId:'PA-2024-1010', applicantName:'Liam Wilson', propertyAddress:'12 Court Street, Hamilton', appType:'Renovation', description:'Add extension to office building', submitDate:'2024-11-09', status:'review', currentStage:'Planning Review', contactEmail:'lwilson@office.bm'}
        ];

        function calculateDaysSince(date){
            const diffTime = new Date() - new Date(date);
            return Math.ceil(diffTime/(1000*60*60*24));
        }

        function renderApplications(appsToRender=applications){
            // Sort applications by submitDate (most recent first)
            const sortedApps = [...appsToRender].sort((a, b) => new Date(b.submitDate) - new Date(a.submitDate));
            
            const tbody = document.getElementById('applications-tbody');
            tbody.innerHTML='';
            sortedApps.forEach(app=>{
                const days=calculateDaysSince(app.submitDate);
                const statusClass=app.status==='approved'?'status-approved':app.status==='rejected'?'status-rejected':app.status==='review'?'status-review':'status-submitted';
                const statusText=app.status==='approved'?'Approved':app.status==='rejected'?'Rejected':app.status==='review'?'Under Review':'Submitted';
                tbody.innerHTML+=`
                    <tr>
                        <td><strong>${app.appId}</strong></td>
                        <td>${app.applicantName}</td>
                        <td>${app.propertyAddress}</td>
                        <td>${app.appType}</td>
                        <td>${new Date(app.submitDate).toLocaleDateString()}<br><small>${days} days ago</small></td>
                        <td><span class="workflow-stage">${app.currentStage}</span></td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td><button class="btn btn-secondary" style="padding:8px 16px;font-size:12px;" onclick="viewApplication(${app.id})">View</button></td>
                    </tr>
                `;
            });
            updateStats();
        }

        function updateStats(){
            document.getElementById('total-applications').textContent=applications.length;
            document.getElementById('pending-review').textContent=applications.filter(a=>a.status==='review').length;
            document.getElementById('approved-month').textContent=applications.filter(a=>a.status==='approved').length;
        }

        function filterApplications(){
            const term=document.getElementById('search-input').value.toLowerCase();
            const status=document.getElementById('filter-status').value;
            const filteredApps = applications.filter(a=>(a.applicantName.toLowerCase().includes(term)||a.propertyAddress.toLowerCase().includes(term)||a.appId.toLowerCase().includes(term))&&(status==='all'||a.status===status));
            renderApplications(filteredApps);
        }

        function showNewApplicationModal(){ 
            document.getElementById('new-application-modal').classList.add('active'); 
        }
        
        function closeModal(){ 
            document.getElementById('new-application-modal').classList.remove('active'); 
        }

        function submitApplication(e){
            e.preventDefault();
            const newApp={
                id:applications.length+1,
                appId:document.getElementById('app-id').value,
                applicantName:document.getElementById('applicant-name').value,
                propertyAddress:document.getElementById('property-address').value,
                appType:document.getElementById('app-type').value,
                description:document.getElementById('description').value,
                submitDate:document.getElementById('submit-date').value,
                status:'submitted',
                currentStage:'Initial Review',
                contactEmail:document.getElementById('contact-email').value
            };
            applications.push(newApp);
            localStorage.setItem('planning_applications',JSON.stringify(applications));
            renderApplications();
            closeModal();
            e.target.reset();
            alert('✅ Planning application submitted successfully!\nApplication ID: '+newApp.appId);
        }

        function viewApplication(id){
            const app=applications.find(a=>a.id===id);
            alert(`Application Details:\n\nID: ${app.appId}\nApplicant: ${app.applicantName}\nProperty: ${app.propertyAddress}\nType: ${app.appType}\nStatus: ${app.status}\nCurrent Stage: ${app.currentStage}\n\nDescription: ${app.description}`);
        }

        function trackApplication(){
            const trackingId=document.getElementById('tracking-id').value.toUpperCase();
            const app=applications.find(a=>a.appId.toUpperCase()===trackingId);
            const div=document.getElementById('tracking-result');
            if(app){
                const days=calculateDaysSince(app.submitDate);
                const statusClass=app.status==='approved'?'status-approved':app.status==='rejected'?'status-rejected':app.status==='review'?'status-review':'status-submitted';
                const statusText=app.status==='approved'?'Approved':app.status==='rejected'?'Rejected':app.status==='review'?'Under Review':'Submitted';
                
                div.innerHTML=`<div class="tracking-card">
                    <h3>Application Found: ${app.appId}</h3>
                    <div class="tracking-details">
                        <div><strong>Applicant:</strong> ${app.applicantName}</div>
                        <div><strong>Property:</strong> ${app.propertyAddress}</div>
                        <div><strong>Type:</strong> ${app.appType}</div>
                        <div><strong>Submitted:</strong> ${new Date(app.submitDate).toLocaleDateString()} (${days} days ago)</div>
                        <div><strong>Current Stage:</strong> <span class="workflow-stage">${app.currentStage}</span></div>
                        <div><strong>Status:</strong> <span class="status-badge ${statusClass}">${statusText}</span></div>
                        <div><strong>Contact Email:</strong> ${app.contactEmail}</div>
                    </div>
                </div>`;
            } else {
                div.innerHTML=`<div style="background:#fee2e2;padding:20px;border-radius:10px;color:#991b1b;border-left:4px solid #b91c1c;"><strong>Application not found.</strong><br>Please check your Application ID and try again.</div>`;
            }
        }

        function showTab(tabName, evt){
            document.querySelectorAll('[id$="-tab"]').forEach(tab=>tab.classList.add('hidden'));
            document.getElementById(tabName+'-tab').classList.remove('hidden');
            document.querySelectorAll('.nav-tab').forEach(btn=>btn.classList.remove('active'));
            if(evt) evt.currentTarget.classList.add('active');
        }

        // Mobile menu toggle
        document.querySelector('.mobile-menu-btn').addEventListener('click', function() {
            document.querySelector('.nav-links').classList.toggle('active');
        });

        // Initialize
        renderApplications();
    </script>
</body>
</html>
